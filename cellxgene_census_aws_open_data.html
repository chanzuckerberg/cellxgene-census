

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CZ CELLxGENE Discover Census in AWS &mdash; cellxgene-census  documentation</title>
  

  
  <link rel="icon" type="image/png" sizes="32x32" href="_static/img/favicon_32x32_v2.png"/>
  <link rel="icon" type="image/png" sizes="16x16" href="_static/img/favicon_16x16_v2.png"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script data-domain="chanzuckerberg.github.io/cellxgene-census" defer="defer" src="https://plausible.io/js/script.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Census data and schema" href="cellxgene_census_docsite_schema.html" />
    <link rel="prev" title="Introducing a normalized layer and pre-calculated cell and gene statistics in Census" href="articles/2023/20231012-normalized_layer_precalc_stats.html" /> 
</head>

<body class="wy-body-for-nav">

  <div style="height: 100vh; overflow: hidden;">
     
    <!-- top 56px for navbar height -->
    <div class="navbar-cxg">
        <div style="padding: 0 16px; display: flex; height: inherit; align-items: center; justify-content: space-between;">
            <span style="display:flex; gap: 32px; align-items: center;">
                <a href="https://cellxgene.cziscience.com/">
                  <img src="_static/img/cellxgene-discover-logo.svg" />
                </a>
                <span class="navbar-cxg-nav-wrapper">
                  <span class="navbar-cxg-section">
                    <span class="navbar-cxg-nav-section-title">Application</span>
                    <span class="navbar-cxg-nav-item-container">
                      <span class="navbar-cxg-link">
                          <a class="navbar-cxg-anchor" href="https://cellxgene.cziscience.com/collections">Collections</a>
                      </span>
                      <span class="navbar-cxg-link">
                          <a class="navbar-cxg-anchor" href="https://cellxgene.cziscience.com/datasets">Datasets</a>
                      </span>
                      <span class="navbar-cxg-link">
                          <a class="navbar-cxg-anchor" href="https://cellxgene.cziscience.com/gene-expression">Gene Expression</a>
                      </span>
                      <span class="navbar-cxg-link">
                        <a class="navbar-cxg-anchor" href="https://cellxgene.cziscience.com/cellguide">Cell Guide</a>
                        <div style="height: 16px!important; display: flex;">
                          <span class="beta">BETA</span>
                        </div>
                      </span>
                    </span>
                  </span>
                  <hr class="navbar-divider"/>
                  <span class="navbar-cxg-section">
                    <span class="navbar-cxg-nav-section-title">Census</span>
                    <span class="navbar-cxg-nav-item-container">
                      <span class="navbar-cxg-link active-link">
                        <a class="navbar-cxg-anchor" href="/cellxgene-census/index.html">API</a>
                      </span>
                      <span class="navbar-cxg-link">
                        <a class="navbar-cxg-anchor" href="https://cellxgene.cziscience.com/census-models">Models</a>
                      </span>
                    </span>
                  </span>
                </span>
            </span>

            <span class="navbar-cxg-link">
              <a class="navbar-cxg-anchor" href="https://cellxgene.cziscience.com/docs">Help & Documentation</a>
            </span>
        </div>
    </div>
    <div style="width: 100%; height: 100%; overflow: auto; padding-top: 56px;">
        
        <!-- top 56px for navbar height -->
        <nav data-toggle="wy-nav-shift" class="wy-nav-side" style="top: 56px;" >
        <div class="wy-side-scroll">
            <div class="wy-side-nav-search" >
            

            
                <a href="index.html" class="icon icon-home"> cellxgene-census
            

            
            </a>

            
                
                
                <div class="version">
                    v1.10.2
                </div>
                
            

            

            
            </div>

            
            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            
                
                
                
                
                
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="cellxgene_census_docsite_installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="cellxgene_census_docsite_quick_start.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles.html">What’s new?</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Census in AWS ☁️</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#census-data-available-in-aws">Census data available in AWS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#data-specifications">Data specifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-release-versioning">Data release versioning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-access-aws-census-data">How to access AWS Census data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#aws-cli-for-programatic-downloads">AWS CLI for programatic downloads</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cellxgene-census-api-python-and-r">CELLxGENE Census API (Python and R)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tiledb-soma-api-python-and-r">TileDB-SOMA API (Python and R)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cellxgene_census_docsite_schema.html">Census data and schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="cellxgene_census_docsite_data_release_info.html">Census data releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="python-api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Python tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://chanzuckerberg.github.io/cellxgene-census/r/index.html">R API &amp; tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="cellxgene_census_docsite_FAQ.html">FAQ</a></li>
</ul>

                
            
            </div>
            
        </div>
        </nav>

        <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

        
        <nav class="wy-nav-top" aria-label="top navigation">
            
            <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
            <a href="index.html">cellxgene-census</a>
            
        </nav>


        <div class="wy-nav-content">
            
            <div class="rst-content">
            
            <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">CZ CELLxGENE Discover Census in AWS</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/cellxgene_census_aws_open_data.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
            <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div itemprop="articleBody">
                
  <section id="cz-cellxgene-discover-census-in-aws">
<h1>CZ CELLxGENE Discover Census in AWS<a class="headerlink" href="#cz-cellxgene-discover-census-in-aws" title="Permalink to this heading">¶</a></h1>
<p>The single-cell data from <a class="reference internal" href="cellxgene_census_docsite_landing.html"><span class="std std-doc">CZ CELLxGENE Discover Census</span></a> are available for public access via Amazon Web Services (AWS).</p>
<p>This page describes what Census data are available in AWS and how to access them.</p>
<p>Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#census-data-available-in-aws"><span class="std std-ref">Census data available in AWS</span></a></p></li>
<li><p><a class="reference internal" href="#how-to-access-aws-census-data"><span class="std std-ref">How to access AWS Census data</span></a></p></li>
</ul>
<section id="census-data-available-in-aws">
<h2>Census data available in AWS<a class="headerlink" href="#census-data-available-in-aws" title="Permalink to this heading">¶</a></h2>
<p>The single-cell data from CZ CELLxGENE Discover included in Census (see <a class="reference internal" href="cellxgene_census_docsite_schema.html#data-included-in-the-census"><span class="std std-ref">inclusion criteria</span></a>) are available either as Census-wide TileDB files or individual H5AD files of the source datasets.</p>
<section id="data-specifications">
<h3>Data specifications<a class="headerlink" href="#data-specifications" title="Permalink to this heading">¶</a></h3>
<table class="custom-table">
<thead>
    <th>Data</th>
    <th>Format</th>
    <th>Access API</th>
    <th>Data schema</th>
    <th>Root S3 bucket</th>
    <th>Regions</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td rowspan="2">Census-wide</td>
    <td rowspan="2"><a href="https://github.com/TileDB-Inc/TileDB">TileDB</a></td>
    <td><a href="https://github.com/chanzuckerberg/cellxgene-census/tree/main">CELLxGENE-Census</a></td>
    <td rowspan="2"><a href="https://github.com/chanzuckerberg/cellxgene-census/blob/main/docs/cellxgene_census_schema.md">CZ CELLxGENE Discover <b>Census</b> Schema</a></td>
    <td rowspan="2">s3://cellxgene-census-public-us-west-2/cell-census/<code>[tag]</code>/soma/</td>
    <td rowspan="3">us-west-2</td>
  </tr>
  <tr>
    <td><a href="https://github.com/single-cell-data/TileDB-SOMA">TileDB-SOMA</a></td>
  </tr>
  <tr>
    <td rowspan>Source datasets</td>
    <td rowspan"><a href="https://anndata.readthedocs.io/en/latest/fileformat-prose.html#elements">H5AD</a></td>
    <td><a href="https://anndata.readthedocs.io/en/latest/index.html">AnnData</a></td>
    <td rowspan><a href="https://github.com/chanzuckerberg/single-cell-curation/tree/main/schema">CZ CELLxGENE Discover <b>Dataset</b> Schema</a></td>
    <td rowspan>s3://cellxgene-census-public-us-west-2/cell-census/<code>[tag]</code>/h5ads/</td>
  </tr>
</tbody>
</table>
<p>See the next section for a definition of <code class="docutils literal notranslate"><span class="pre">[tag]</span></code>.</p>
</section>
<section id="data-release-versioning">
<h3>Data release versioning<a class="headerlink" href="#data-release-versioning" title="Permalink to this heading">¶</a></h3>
<p>A data release is a Census build that is publicly hosted in AWS. A Census build is a TileDB-SOMA collection and its corresponding source H5AD files with the Census data from CZ CELLxGENE Discover.</p>
<p>Any given Census build is named with a unique <code class="docutils literal notranslate"><span class="pre">[tag]</span></code>, normally the date of build, e.g. “2023-05-15”.</p>
<p>The are two types of data releases:</p>
<ul class="simple">
<li><p>Long-Term Supported (LTS).</p></li>
<li><p>Weekly.</p></li>
</ul>
<p>For more information and for a list of all LTS Census data releases available please refer to <a class="reference internal" href="cellxgene_census_docsite_data_release_info.html"><span class="std std-doc">Census data releases</span></a>.</p>
</section>
</section>
<section id="how-to-access-aws-census-data">
<h2>How to access AWS Census data<a class="headerlink" href="#how-to-access-aws-census-data" title="Permalink to this heading">¶</a></h2>
<section id="aws-cli-for-programatic-downloads">
<h3>AWS CLI for programatic downloads<a class="headerlink" href="#aws-cli-for-programatic-downloads" title="Permalink to this heading">¶</a></h3>
<p>Users can bulk-download Census data via the <a class="reference external" href="https://aws.amazon.com/cli/">AWS CLI</a>.</p>
<p>For example, to download the H5ADs files of the Census LTS release <code class="docutils literal notranslate"><span class="pre">2023-07-25</span></code>, users can execute the following from a shell session:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>aws<span class="w"> </span>s3<span class="w"> </span>sync<span class="w"> </span>--no-sign-request<span class="w"> </span>s3://cellxgene-census-public-us-west-2/cell-census/2023-07-25/h5ads/<span class="w"> </span>./h5ads/
</pre></div>
</div>
<p>And to download the TileDB files:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>aws<span class="w"> </span>s3<span class="w"> </span>sync<span class="w"> </span>--no-sign-request<span class="w"> </span>s3://cellxgene-census-public-us-west-2/cell-census/2023-07-25/soma/<span class="w"> </span>./soma/
</pre></div>
</div>
</section>
<section id="cellxgene-census-api-python-and-r">
<h3>CELLxGENE Census API (Python and R)<a class="headerlink" href="#cellxgene-census-api-python-and-r" title="Permalink to this heading">¶</a></h3>
<p>This is the recommend method for accessing Census data. Please follow the <a class="reference internal" href="cellxgene_census_docsite_quick_start.html"><span class="std std-doc">Census API quick start guide</span></a> for a full guide.</p>
<p>For example, in Python users can create an iterator for the cell metadata Data Frame as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cellxgene_census</span>

<span class="k">with</span> <span class="n">cellxgene_census</span><span class="o">.</span><span class="n">open_soma</span><span class="p">()</span> <span class="k">as</span> <span class="n">census</span><span class="p">:</span>
    <span class="n">cell_metadata</span> <span class="o">=</span> <span class="n">census</span><span class="p">[</span><span class="s2">&quot;census_data&quot;</span><span class="p">][</span><span class="s2">&quot;homo_sapiens&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">read</span><span class="p">(</span>
        <span class="n">value_filter</span> <span class="o">=</span> <span class="s2">&quot;sex == &#39;female&#39; and cell_type in [&#39;microglial cell&#39;, &#39;neuron&#39;]&quot;</span><span class="p">,</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;assay&quot;</span><span class="p">,</span> <span class="s2">&quot;cell_type&quot;</span><span class="p">,</span> <span class="s2">&quot;tissue&quot;</span><span class="p">,</span> <span class="s2">&quot;tissue_general&quot;</span><span class="p">,</span> <span class="s2">&quot;suspension_type&quot;</span><span class="p">,</span> <span class="s2">&quot;disease&quot;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>If a <strong>local copy</strong> of the Census data exists, users can access it by providing the path to the <code class="docutils literal notranslate"><span class="pre">soma/</span></code> folder.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cellxgene_census</span>

<span class="k">with</span> <span class="n">cellxgene_census</span><span class="o">.</span><span class="n">open_soma</span><span class="p">(</span><span class="n">uri</span><span class="o">=</span><span class="s2">&quot;local/path/to/soma/&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">census</span><span class="p">:</span>
   <span class="o">...</span>
</pre></div>
</div>
<p>If a copy of the Census data exists in a <strong>private S3 bucket</strong>, users can access it by providing the URI <code class="docutils literal notranslate"><span class="pre">soma/</span></code>
folder in the S3 bucket. This will also require customizing TileDB configuration options to specify the
bucket’s AWS region and that signed requests should be used for S3 API calls. This can be done as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cellxgene_census</span>

<span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;s3://my-private-data-bucket/cell-census/2023-07-25/soma/&quot;</span>

<span class="n">tiledb_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;vfs.s3.no_sign_request&quot;</span><span class="p">:</span> <span class="s2">&quot;false&quot;</span><span class="p">,</span>
               <span class="s2">&quot;vfs.s3.region&quot;</span><span class="p">:</span> <span class="s2">&quot;us-east-1&quot;</span><span class="p">}</span>

<span class="k">with</span> <span class="n">cellxgene_census</span><span class="o">.</span><span class="n">open_soma</span><span class="p">(</span><span class="n">uri</span><span class="o">=</span><span class="n">uri</span><span class="p">,</span> <span class="n">tiledb_config</span><span class="o">=</span><span class="n">tiledb_config</span><span class="p">)</span> <span class="k">as</span> <span class="n">census</span><span class="p">:</span>
   <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="tiledb-soma-api-python-and-r">
<h3>TileDB-SOMA API (Python and R)<a class="headerlink" href="#tiledb-soma-api-python-and-r" title="Permalink to this heading">¶</a></h3>
<p>The Census API provides convenience wrappers for TileDB-SOMA to access the Census Data hosted at AWS. Users can interact directly with the Census TileDB data directly via the TileDB-SOMA APIs. Please refer to the <a class="reference external" href="https://tiledbsoma.readthedocs.io/en/latest/">TileDb-SOMA documentation</a> for full details on usage.</p>
<p>For example, in Python users can create an iterator for the cell metadata Data Frame as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cellxgene_census</span>
<span class="kn">import</span> <span class="nn">tiledbsoma</span>

<span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;s3://cellxgene-census-public-us-west-2/cell-census/2023-07-25/soma/&quot;</span>
<span class="n">ctx</span> <span class="o">=</span> <span class="n">cellxgene_census</span><span class="o">.</span><span class="n">get_default_soma_context</span><span class="p">()</span>

<span class="k">with</span> <span class="n">tiledbsoma</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">ctx</span><span class="p">)</span> <span class="k">as</span> <span class="n">census</span><span class="p">:</span>
    <span class="n">cell_metadata</span> <span class="o">=</span> <span class="n">census</span><span class="p">[</span><span class="s2">&quot;census_data&quot;</span><span class="p">][</span><span class="s2">&quot;homo_sapiens&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">read</span><span class="p">(</span>
        <span class="n">value_filter</span> <span class="o">=</span> <span class="s2">&quot;sex == &#39;female&#39; and cell_type in [&#39;microglial cell&#39;, &#39;neuron&#39;]&quot;</span><span class="p">,</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;assay&quot;</span><span class="p">,</span> <span class="s2">&quot;cell_type&quot;</span><span class="p">,</span> <span class="s2">&quot;tissue&quot;</span><span class="p">,</span> <span class="s2">&quot;tissue_general&quot;</span><span class="p">,</span> <span class="s2">&quot;suspension_type&quot;</span><span class="p">,</span> <span class="s2">&quot;disease&quot;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>


            </div>
            
            </div>
            <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="articles/2023/20231012-normalized_layer_precalc_stats.html" class="btn btn-neutral float-left" title="Introducing a normalized layer and pre-calculated cell and gene statistics in Census" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cellxgene_census_docsite_schema.html" class="btn btn-neutral float-right" title="Census data and schema" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Chan Zuckerberg Initiative.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
            </div>
        </div>

        </section>

    </div>
    <!-- Newsletter Banner -->
    <div role="banner" id="newsletter-banner">
      <span id="newsletter-subscribe-button" role="button">Subscribe</span>&nbsp;to our newsletter to receive updates about new features.
      <div id="newsletter-banner-close-button" role="button">X</div>
    </div>
    <!-- Newsletter Modal -->
    <dialog id="newsletter-modal">
      <div id="newsletter-header">
        <img id="newsletter-logo" src="_static/img/cellxGene-newsletter-logo.svg" />
        <div id="newsletter-close-button" role="button">X</div>
      </div>
      <div id="newsletter-content">
        <div id="newsletter-callout">Join Our Newsletter</div>
        <div id="newsletter-description">Get a quarterly email with the latest CELLxGENE features and data.</div>
        <!-- HubSpot Form target -->
        <div id="newsletter-form-container"></div>
      </div>

      <div id="newsletter-footnote">Unsubscribe at any time.</div>
    </dialog>
  </div>
  

  <script>
    // (thuang): 30 days
    const NEWSLETTER_BANNER_DISMISSED_TTL_MS = 30 * 24 * 60 * 60 * 1000;
    const NEWSLETTER_BANNER_DISMISSED_KEY = "newsletterBannerDismissed"

    var script = document.createElement('script');
    script.src = 'https://js.hsforms.net/forms/v2.js';
    script.defer = true;
    document.head.appendChild(script);

    // Run the code once the script is loaded
    script.onload = async function() {
      await hbspt.forms.create({
        region: "na1",
        portalId: "7272273",
        formId: "eb65b811-0451-414d-8304-7b9b6f468ce5",
        target: '#newsletter-form-container',
        onFormReady() {
          // get element by type "email"
          const emailInput = document.querySelector('#email-eb65b811-0451-414d-8304-7b9b6f468ce5');
          emailInput.setAttribute('placeholder', 'Enter email address');

          // remove the label element for emailInput
          const emailLabel = document.querySelector('#label-email-eb65b811-0451-414d-8304-7b9b6f468ce5');
          emailLabel.remove();
        },
        submitText: 'Subscribe',
      });
    };

    checkNewsletterBanner();

    document.querySelector('#newsletter-banner-close-button').addEventListener('click', () => {
      document.querySelector('#newsletter-banner').remove();
      localStorage.setItem(NEWSLETTER_BANNER_DISMISSED_KEY, Date.now());
    });

    const modal = document.querySelector('#newsletter-modal');

    document.querySelector('#newsletter-subscribe-button').addEventListener('click', () => {
      modal.showModal();
    });

    document.querySelector('#newsletter-close-button').addEventListener('click', () => {
      modal.close();
    });

    function checkNewsletterBanner() {
      /**
       * (thuang): Use LocalStorage to store dismissed state for 30 days
       * NOTE: Currently Census doc page doesn't share the same domain as the main site,
       * so dismissing the banner on the main site won't dismiss it on the Census doc page.
       * And vice versa.
       */
      const newsletterBannerDismissed = localStorage.getItem('newsletterBannerDismissed');

      if (newsletterBannerDismissed) {
        return;
      }

      if (newsletterBannerDismissed && Date.now() - newsletterBannerDismissed > NEWSLETTER_BANNER_DISMISSED_TTL_MS) {
        localStorage.removeItem(NEWSLETTER_BANNER_DISMISSED_KEY);
      }

      const newsletterBanner = document.querySelector('#newsletter-banner');

      if (!newsletterBannerDismissed) {
        newsletterBanner.style.display = 'flex';
      }
    }
  </script>

  
  
    
   

</body>
</html>